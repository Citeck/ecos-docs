Описание создания процесса запроса на закупку оборудования
============================================================

Данная статья знакомит пользователей с основами ECOS на примере создания бизнес-процесса «Заявка на закупку оборудования».

**Заявка на оборудование** – заявка, которая необходима для закупки оборудования для операционной деятельности сотрудников. Например, для подключения монитора к компьютеру сотруднику необходим специальный кабель, которого на данный момент нет в наличии. 

Обычно сотрудник обращается к своему руководителю с просьбой, чтобы для него (сотрудника) необходимое оборудование было приобретено, после согласования с руководителем и в соответствии с внутренними правилами и распорядками происходит закупка. 

Далее мы пошагово реализуем описанный сценарий с использованием инструментов ECOS.

Для закупки оборудования нам потребуется следующая информация: 

    -	**Инициатор** – сотрудник, которому необходимо оборудование; 
    -	**Согласующий** – сотрудник, ответственный за согласование приобретаемого оборудования;
    -	**Название** – наименование приобретаемого оборудования; 
    -	**Стоимость** – стоимость оборудования.

До создания самого бизнес-процесса необходимо создать ряд :ref:`артефактов<ecos_artifacts>` в следующем порядке:

    - :ref:`тип данных<data_types_main>`;
    - :ref:`журнал<journals>`;
    - :ref:`форма <forms>` ;
    - :ref:`процесс<ecos_bpmn>`.

Тип данных
----------

**Тип данных** - основной источник метаданных работы с объектом.

Для создания типа данных перейдите в журнал **«Типы данных» (Раздел администратора - Модель - Журналы)**:

  .. image:: _static/equipment_request/type_new_1.png
       :width: 600
       :align: center

нажмите **+ - Создать новый тип**:

  .. image:: _static/equipment_request/type_new_2.png
       :width: 600
       :align: center

Основное
~~~~~~~~

На вкладке расположены основные данные по типу данных (объекту):

.. list-table:: 
      :widths: 10 20 30
      :align: center
      :class: tight-table 

      * - **1**
        - id
        - equipment-request
      * - **2**
        - Имя
        - Заявка на покупку оборудования
      * - **3**
        - Родитель
        - Кейс
      * - **4**
        - Форма
        - Оставляем по умолчанию (система автоматически сгенерирует форму по тем атрибутам, которые мы укажем далее, но автоматически сгенерированные формы нельзя редактировать)
      * - **5**
        - Журнал
        - Оставляем по умолчанию (система автоматически сгенерирует журнал по тем атрибутам, которые мы укажем далее, но автоматически сгенерированные журналы нельзя редактировать)

Конечная настройка вкладки:

  .. image:: _static/equipment_request/tab_1.png
       :width: 600
       :align: center

Атрибуты
~~~~~~~~

На вкладке находится информация о свойствах, которые будут использованы для взаимодействия с объектом.

Для создания заявки нам потребуется следующая информация: 
    -	что нужно купить, 
    -	сколько стоит, 
    -	кто запрашивает 
    -	кто согласует закупку.

И, соответственно, нам потребуются следующие атрибуты (свойства объекта):

.. list-table:: 
      :widths: 10 20 30
      :header-rows: 1
      :align: center
      :class: tight-table 

      * - Id (1)
        - Имя (2)
        - Тип (3)
      * - name
        - Название оборудования
        - Text
      * - price
        - Стоимость
        - Number
      * - requester
        - Инициатор
        - Person
      * - approver
        - Согласующий
        - Person

Конечная настройка вкладки:

  .. image:: _static/equipment_request/tab_2.png
       :width: 600
       :align: center


Роли
~~~~

На вкладке описываются роли, которые участвуют в работе с объектом, в нашем случае, участвуют в работе с заявкой.  

Смотря на атрибуты, несложно догадаться, что нам потребуется на первом этапе две роли: **Инициатор** и **Согласующий**. 

.. list-table:: 
      :widths: 10 20 30
      :header-rows: 1
      :align: center
      :class: tight-table 

      * - Id (1)
        - Имя (2)
        - | Атрибут (3) 
          | (Выбирается из указанных ранее атрибутов. 
          | По клику на поле, выпадает список указанных атрибутов на вкладке "Атрибуты")
      * - requestor
        - Инициатор
        - Инициатор
      * - approver
        - Согласующий
        - Согласующий


Конечная настройка вкладки:

  .. image:: _static/equipment_request/tab_3.png
       :width: 600
       :align: center


Статусы
~~~~~~~

На вкладке описываются статусы, по которым будет перемещаться объект (наша заявка) по бизнес-процессу. 

Рассмотрим самый простой и успешный вариант процесса. 

Инициатор создаёт заявку (статус **«Заявка создана»**), далее отправляет её на согласование согласующему (статус **«На согласовании»**), после Согласующий одобряет заявку (статус **«Одобрено»/«Согласовано»**). 

.. list-table:: 
      :widths: 10 20
      :header-rows: 1
      :align: center
      :class: tight-table 

      * - Id (1)
        - Имя (2)
      * - request-created
        - Заявка создана
      * - approving
        - На согласовании
      * - approved
        - Согласовано

Конечная настройка вкладки:

  .. image:: _static/equipment_request/tab_4.png
       :width: 600
       :align: center

Для сохранения нажмите **«Создать» (Сохранить)**. 

На этом создание базового варианта типа данных для заявки закончено. 

Промежуточный итог
~~~~~~~~~~~~~~~~~~~~~

-	указали базовую информацию о типе данных: id, название типа данных, 
-   форму и журнал система сгенерировала автоматически на основании введенных данных;
-	описали свойства заявки, с которыми дальше будем взаимодействовать;
-	добавили роли, которые будут участвовать в работе с заявкой;
-	обозначили статусы, по которым будет перемещаться заявка.

Форма
------

Посмотрим, как выглядит сгенерированная автоматически форма. Помните, что автоматически сгенерированные формы нельзя редактировать.

Для этого на открывшейся вкладке «Тип «Заявка на покупку оборудования» нажмите **«Форма по умолчанию»**. 

  .. image:: _static/equipment_request/auto_form_1.png
       :width: 600
       :align: center

В открывшейся вкладке в виджете **«Действия»** нажмите  **«Редактировать форму»**:

  .. image:: _static/equipment_request/auto_form_2.png
       :width: 600
       :align: center

Данная форма была автоматически сгенерирована системой из атрибутов, которые были указаны в типе данных: 

  .. image:: _static/equipment_request/auto_form_3.png
       :width: 600
       :align: center

Тип компонента на форме зависит от типа атрибута, указанного в типе данных. 

Например, компонент **Стоимость** имеет тип **Number**, так как в типе атрибута был указано значение Number. 

Это можно проверить, наведя курсор на компонент с названием **«Стоимость»**, и далее, нажав на шестерёнку в правом-верхнем углу компонента^

  .. image:: _static/equipment_request/auto_form_4.png
       :width: 600
       :align: center

В заголовке модального окна видно, что компонент имеет тип **Number**. 

А в поле **Имя свойства** указано значение **«price»**, это значение было указано ранее в типе данных.

  .. image:: _static/equipment_request/auto_form_5.png
       :width: 600
       :align: center

Журнал
-------

Для просмотра журнала необходимо его добавить в левое меню:

1.	Перейдите в настройку меню, нажав на шестеренку справа сверху, далее выбрать **«Настроить меню»**:

  .. image:: _static/equipment_request/menu_1.png
       :width: 600
       :align: center

2.	Перейдите во вкладку **«Настройки выбранной конфигурации»**, нажмите **«+ Добавить»**, выберите **«Раздел»**:

  .. image:: _static/equipment_request/menu_2.png
       :width: 600
       :align: center

3.	В поле **«Название»** введите название раздела. Например, «Оборудование». Нажмите **«Сохранить»**.

  .. image:: _static/equipment_request/menu_3.png
       :width: 400
       :align: center

4.	Наведите курсор на добавленный раздел, нажмите **«+ Добавить»**, выберите **«Журнал»**:

  .. image:: _static/equipment_request/menu_4.png
       :width: 600
       :align: center

Выберите журнал **«type$equipment-request»** и нажмите **ОК**:

  .. image:: _static/equipment_request/menu_5.png
       :width: 600
       :align: center

  .. image:: _static/equipment_request/menu_6.png
       :width: 600
       :align: center

5.	Нажмите «Применить».

В левом меню появился новый журнал **«Заявка на покупку оборудования»**:

  .. image:: _static/equipment_request/menu_7.png
       :width: 300
       :align: center

Нажав на этот пункт меню, откроется новая ECOS вкладка с автоматически сгенерированным журналом. 
В журнале присутствуют колонки, которые относятся непосредственно к атрибутам, которые были указаны ранее в типе данных:

  .. image:: _static/equipment_request/journal_1.png
       :width: 600
       :align: center

Создать заявку в журнале пока невозможно, так как для объекта пока не задано описание процесса, по которому будет проходить его жизненный цикл.
