============
**Формы**
============

Новые формы ECOS реализованы на базе движка `formiojs <https://github.com/formio/formio.js>`_

Функция редактора форм доступна только в ECOS Enterprise

Формы описываются в json формате

Формы используются для редактирования записей из Records Service (см. 11. ECOS Records). На бэкэнде редактирование записи может восприниматься как создание новой (например если не указан ID редактируемой записи).

Существуют две системные формы, которые изменять не желательно:

	1) Форма для создания и редактирования других форм. Ключ: ECOS_FORM
	2) Форма по-умолчанию. Она используется как отправная точка если мы создаем новую форму. Ключ: DEFAULT
**Атрибут - это собирательный термин, который относится и к свойству и ассоциации и к дочерней ассоциации и к системным свойствам;**

Связь с типом Alfresco
----------------------
Если мы хотим создать форму для создания или редактирования типа Alfresco, то следует создать форму с ключом, который сформирован

по следующему шаблону: alf_{{ТИП-ALFRESCO}}

Например: alf_idocs:contractor

Связь с типом ECOS
------------------
Если нужна форма для создания/редактирования/просмотра записи с типом ECOS следует задать ключ по следующему шаблону:

type_{{TYPE_UUID}}/{{KIND_UUID}}
Если вид не важен, то его можно не задавать и сделать ключ type_{{TYPE_UUID}}
Например:
Для типа+вида: type_contracts-cat-doctype-contract/contracts-cat-contract-services
Для типа: type_contracts-cat-doctype-contract
В консоли браузера можно проверить список возможных ключей форм для записи следующим скриптом:

::

 Citeck.Records.get('workspace://SpacesStore/86f922df-924a-46a6-a9e3-e34ddb96ef7d').load("_formKey[]?str").then(console.log)

Пользовательский модуль
-----------------------
В json описании формы можно добавить поле "customModule", в котором записать путь до javascript модуля, который будет создан вместе с формой. В этом модуле можно разместить сложную логику, которую в последствии вызывать из скриптов формы. Для примера см. ecos-eform-repo/src/main/resources/alfresco/module/ecos-eform-repo/ecos-forms\ecos-form.json

Если в customModule будет метод init, то он будет вызван с текущей формой в аргументах.

Проверка новых форм
~~~~~~~~~~~~~~~~~~~
Чтобы открыть конкретную форму для редактирования или создания следует в консоли браузера выполнить следующий скрипт::

 Citeck.forms.eform('wftask@activiti$875', {params:{formKey:'DEFAULT'}})

Первый аргумент - RecordRef, кототорый будет редактироваться
Параметр formKey - ключ формы, которую следует открыть



Конфигурация ecos-forms-enable
------------------------------
В ECOS конфигурации добавлен параметр ecos-forms-enable, который позволяет глобально отключать новые формы для создания нод. По-умолчанию данный параметр включен.


Служебные данные формы
----------------------

Form Builder
------------

Компоненты формы
~~~~~~~~~~~~~~~~

API
~~~~~

Display (Отображение на форме)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Validation (Связь с моделью)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Условия отображения
~~~~~~~~~~~~~~~~~~~~~~~

Logic
~~~~~~~~~~

Layout (Отображение в HTML?)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Локализация
------------

Формы для задач
----------------

Activity
~~~~~~~~~~

Mobile App form
---------------

