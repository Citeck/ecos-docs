Пользовательская задача
=======================

.. _user_task:

 .. image:: _static/user_task/54.png
       :width: 400
       :align: center

.. list-table::
      :widths: 5 5
      :class: tight-table 

      * - Указать **Имя**:
        - 
               .. image:: _static/user_task/55_0.png
                :width: 300
                :align: center

      * - | Указать **реципиентов** - пользователей - исполнителей задачи.
          | Реципиент может быть выбран из списка ролей или указан вручную.
        
        -

               .. image:: _static/user_task/55_1.png
                :width: 300
                :align: center

      * - | При выборе из списка представлен список ролей, заполненных в :ref:`типе данных<roles_statuses>`:

        -     

               .. image:: _static/user_task/55_2.png
                :width: 300
                :align: center

          |

               .. image:: _static/user_task/55_3.png
                :width: 300
                :align: center
                
      * - | Для ввода вручную необходимо выставить флаг "Ручное назначение"
          | В поле указывается **имя** или **recordRef** реципиента. Поддерживаются expression для получения реципиентов из переменных или сервисов. 
          | Expression может вернуть множественное значение - строки разделенные запятой: user1,user2,user3
          | Например:
          | ``ivan.petrov``
          | ``GROUP_company_accountant``
          | ``emodel/authority-group@company_accountant``
          | ``${someVariable}``
          | ``${someService.getRecipients()},petya.voks``
        - 
               .. image:: _static/user_task/55_4.png
                :width: 300
                :align: center
      * - | **Форма задачи** определяет то, что будет отображено при назначении задачи пользователю.
          | 
          | **Форму задачи** можно выбрать из списка, создать или вовсе не указывать, тогда тогда пользователю будут отображены только результаты задачи, указанные в соответствующем поле.
          | Если какие-то задачи могут совпадать, то можно использовать одинаковую форму.
        - 
               .. image:: _static/user_task/56.png
                :width: 300
                :align: center
      
      * - | Указать **срок выполнения** задачи, конкрентную дату.
          | Дата должна быть указана в формате `ISO8601  <https://ru.wikipedia.org/wiki/ISO_8601>`_ 
          | Например: 
          | ``2022-06-26T10:30:00`` - 20 июня 2022 года 10 часов 30 минут 0 секунд
          | или в виде выражения: ``${someDate}``
          | предварительно задав :ref:`переменную execution<execution>` через :ref:`скриптовую задачу<script_task>`
        - 
               .. image:: _static/user_task/56_1.png
                :width: 300
                :align: center
      * - | Выставить **приоритет задачи**, 
        - 
               .. image:: _static/user_task/56_2.png
                :width: 300
                :align: center
      * - | Указать результат задачи (вердикт) – **идентификатор** и **название**.
          | В вердиктах можно настроить темы для кнопки. См. ниже
        - 
               .. image:: _static/user_task/56_3.png
                :width: 300
                :align: center

Темы для кнопок вердикта
------------------------

В вердиктах доступна настройка темы кнопок. Настройка влияет на цвет кнопки по аналогии с кнопками на форме.

 .. image:: _static/user_task/56_4.png
       :width: 400
       :align: center

|

 .. image:: _static/user_task/56_5.png
       :width: 400
       :align: center

Возможные варианты:

 .. image:: _static/user_task/56_6.png
       :width: 400
       :align: center

Примеры:

.. image:: _static/user_task/56_7.png
       :width: 700
       :align: center

|

.. list-table::
      :widths: 5 10
      :class: tight-table 
      :align: center

      * - **1**
        - По умолчанию
      * - **2**
        - Основная
      * - **3**
        - Информация
      * - **4**
        - Успешно
      * - **5**
        - Опасно
      * - **6**
        - Предупреждение

Форма задачи
------------

.. image:: _static/user_task/57.png
       :width: 600
       :align: center

Элементы формы задачи связаны с переменными инстанса (экземпляра) процесса.

Если в области видимости задачи/процесса есть переменная с таким же **id** (Имя свойства), как и у элемента формы, то ее содержимое отобразится на форме. 

При сабмите (публикации) формы задачи переменные будут записаны в переменные процесса.

Элементы формы задачи так же могут быть связаны с переменными документа, по которому идет бизнес-процесс. |br|
Для отображения и обновления переменных документа на форме задачи необходимо добавить элемент с **id** (Имя свойства) с префиксом **_ECM_**, например **_ECM_paymentSum**, где **paymentSum** - свойства документа.

Вердикты задачи
~~~~~~~~~~~~~~~

.. note::
       
       Если форма задачи не указана, то будут отображаться доступные вердикты задачи, заполненые в поле **Результат задачи**. |br|
       Результаты задачи версионируются вместе с описанием процесса.

Для добавления кнопок вердиктов задачи на вашу форму, можно воспользоваться компонентом формы **Task Outcome**, который автоматически формирует кнопки вердиктов исходя из настроек **Результатов задачи**.

Вердикты задачи можно добавить вручную для более гибкой настройки конфгурации. Для этого на форму задачи необходимо добавить кнопку с **«Имя свойства»**, заданным по шаблону **outcome_идентификаторВердикта**. Например, **outcome_approve**.

 .. image:: _static/user_task/58.png
       :width: 600
       :align: center


.. |br| raw:: html

     <br>   