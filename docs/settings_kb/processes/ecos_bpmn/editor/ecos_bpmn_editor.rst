Конструктор бизнес-процесса
===========================

.. _editor_bpmn:

.. contents:: 

Элементы конструктора
---------------------
 .. image:: _static/11.png
       :width: 600
       :align: center

1.	Панель элементов 
2.	Панель свойств элемента - задаются свойства либо самой схемы, либо выделенного элемента.
3.	Свернуть панель свойств элемента
4.	Ползунок для перемещения рабочего пространства
5.	Сохранение черновика процесса
6.	Сохранение процесса
7.	Посмотреть данные процесса в XML 
8.	Сохранение и публикация процесса в движок
9.	Сохранение в формате svg
10.     Включение/ выключение отображения ошибок
11.     Кнопки работы с масштабом

Состав панели элементов
-----------------------

.. list-table::
      :widths: 1 5
      :class: tight-table 

      * - 
               .. image:: _static/12.png
                :width: 30
                :align: center

        - **Activate the hand tool** – используется для перемещения схеиы вверх-вниз, вправо-влево, удерживая ее левой кнопкой мыши.
      * - 
               .. image:: _static/13.png
                :width: 30
                :align: center

        - | **Activate the lasso tool** – используется для выделения области схемы - позволяет выделить несколько элементов схемы, удерживая левую кнопку мыши. 
          | Выделяются все элементы, попавшие в выделяемую область.
      * - 
               .. image:: _static/14.png
                :width: 30
                :align: center

        - | **Activate the create/remove space tool** – позволяет «раздвинуть» или «сжать» схему: указатель мыши ставиться на то место на схеме, где нужно «раздвинуть» или «сжать» схему.
          | И удерживая левую кнопку мыши, указателем переместить часть схемы в нужное место.
      * - 
               .. image:: _static/15.png
                :width: 30
                :align: center

        - | **Activate the global connect tool** - соединяющие элементы: поток управления (сплошная линия) и поток сообщений (прерывистая линия).

Элементы потока управления
--------------------------

.. list-table::
      :widths: 1 5
      :class: tight-table 

      * - 
               .. image:: _static/16.png
                :width: 30
                :align: center

        - **Create StartEvent** - начальное :ref:`событие<bpmn_events>`
      * - 
               .. image:: _static/17.png
                :width: 30
                :align: center

        - **Create Intermediate/Boundary Event** - промежуточное :ref:`событие<bpmn_events>`
      * -
               .. image:: _static/18.png
                :width: 30
                :align: center

        - **Create EndEvent** - завершающее :ref:`событие<bpmn_events>`
      * - 
               .. image:: _static/19.png
                :width: 30
                :align: center

        - **Create Gateway** - развилка или :ref:`шлюз<gateways>`, логический оператор
      * - 
               .. image:: _static/20.png
                :width: 30
                :align: center

        - **Create Task** – задача
      * -
               .. image:: _static/21.png
                :width: 30
                :align: center

        - **Create expanded SubProcess** – несколько task, выделенные в :ref:`отдельную подзадачу<sub_process>`
      * -
               .. image:: _static/89.png
                :width: 30
                :align: center

        - **Create Set document status** – :ref:`изменение значения статуса элемента бизнес-процесса<set_status>`
      * -
               .. image:: _static/24.png
                :width: 30
                :align: center

        - | **Create Pool/Participant** – :ref:`пул<pool>`, используются для разграничении ответственности между задачами, организациями, пользователями. 
          | Пулы взаимодействуют между собой только потоками сообщений.


Любой бизнес-процесс начинается с начального события  и заканчивается конечным событием. См. подробно :ref:`Компоненты ECOS BPMN<ecos_bpmn_components>`

Вы создаете схему БП, выбирая на Панели элементов нужные вам элементы и соединяете их потоками управления. Выделив любой элемент схемы, справа от него появляется панель кнопок: 

 .. image:: _static/26.png
       :width: 300
       :align: center

На панели рядом с элементом расположены следующие кнопки:

.. list-table::
      :widths: 1 5
      :class: tight-table 

      * - 
               .. image:: _static/27.png
                :width: 70
                :align: center

        - создать следующий элемент схемы, связанный с выделенным потоком управления
      * - 
               .. image:: _static/28.png
                :width: 30
                :align: center

        - добавить текст аннотации к элементу
      * - 
               .. image:: _static/89.png
                :width: 30
                :align: center

        - :ref:`изменить значение статуса элемента бизнес-процесса<set_status>`
      * - 
               .. image:: _static/29.png
                :width: 30
                :align: center

        - | изменить тип элемента
          | Нажать для изменения типа элемента и далее выбрать соответствующий тип.
      * - 
               .. image:: _static/30.png
                :width: 30
                :align: center

        - удалить элемент
      * - 
               .. image:: _static/91.png
                :width: 30
                :align: center

        - изменить цвет элемента
      * - 
               .. image:: _static/31.png
                :width: 30
                :align: center

        - связать элемент с любым другим на схеме

.. _bpmn_linter:

Отображения ошибок на схеме БП
-------------------------------

Для информирования о наличии ошибки в схеме бизнес-процесса реализован режим отображения ошибок (линтер). Используется плагин `bpmnlint <https://github.com/bpmn-io/bpmnlint>`_

Режим включается/отключается по кнопке:

 .. image:: _static/linter_3.png
       :width: 300
       :align: center

Показывает ошибки и предупреждения как для элемента:

 .. image:: _static/linter_2.png
       :width: 600
       :align: center

так и суммарное количество ошибок и предупреждений для процесса:

 .. image:: _static/linter_1.png
       :width: 300
       :align: center

.. note:: 

 Процесс с выявленными предупрждениями может быть сохранен и опубликован. Предупреждения основаны на использовании лучших практик.

Стандартные ошибки
~~~~~~~~~~~~~~~~~~~

.. note:: 

 Возможные ошибки элементов процесса описаны в соответствующих разделах.

.. list-table::
      :widths: 10 5 20
      :header-rows: 1
      :class: tight-table 

      * - Название
        - Тип
        - Описание

      * - **Элемент не подключен**
        - Ошибка
        - | Проверяет, связан ли элемент с другими элементами процесса через входящие или исходящие потоки управления.
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_01.png
                :width: 300
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_02.png
                :width: 300
                :align: center
      * - **Процесс/ подпроцесс имеет несколько пустых начальных событий**
        - Ошибка
        - | Проверяет наличие только одного пустого стартового события для каждого процесса (или подпроцесса).
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_03.png
                :width: 300
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_04.png
                :width: 300
                :align: center
      * - **Входящие потоки не объединяются**
        - Предупреждение
        - | Пользователи должны смоделировать параллельный шлюз для достижения желаемого поведения.
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_05.png
                :width: 300
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_05.png
                :width: 300
                :align: center
      * - **Gateway излишний, т.к. имеет только один ввод и вывод**
        - Предупреждение
        - | Правило, проверяющее, имеет ли шлюз только один ввод и вывод. Такие шлюзы лишние, поскольку не несут никакой фуекциональности.
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_07.png
                :width: 300
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_08.png
                :width: 300
                :align: center
      * - **В процессе/подпроцессе отсутствует конечное событие**
        - Ошибка
        - | У каждого процесса и подпроцесса должно быть конечное событие. 
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_09.png
                :width: 300
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_10.png
                :width: 300
                :align: center
      * - **SequenceFlow: является дубликатом**
        - Ошибка
        - | Проверяет, что потоки управления не дублируются. Дублирование потоков управления приводит к непреднамеренному разветвлению.
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_11.png
                :width: 300
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_12.png
                :width: 300
                :align: center
      * - **Разветвления и соединения шлюза**
        - Ошибка
        - | Правило, которое проверяет, одновременно ли разветвляется и соединяется шлюз.
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_13.png
                :width: 300
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_14.png
                :width: 300
                :align: center
      * - **Поток разделяется неявно**
        - Ошибка
        - | Проверяет, не моделируется ли неявное разделение после задачи. Вместо этого пользователям следует явно смоделировать параллельный шлюз.
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_15.png
                :width: 300
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_16.png
                :width: 300
                :align: center
      * - **В стартовом событии отсутствует определение события**
        - Ошибка
        - | Стартовые события внутри событийных подпроцессов должны быть типизированы (иметь определение события), что требует стандарт BPMN 2.0.
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_17.png
                :width: 300
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_18.png
                :width: 300
                :align: center
      * - **В процессе отсутствует начальное событие**
        - Ошибка
        - | Проверяет наличие простого начального события в процессе или подпроцессе (не событийном).
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_19.png
                :width: 300
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_20.png
                :width: 300
                :align: center
      * - **В подпроцессе отсутствует начальное событие**
        - Ошибка
        - | Проверяет, что стартовые события внутри обычных подпроцессов пусты (не имеют определения события).
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_21.png
                :width: 300
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_22.png
                :width: 300
                :align: center
      * - **Событие имеет несколько определений событий**
        - Ошибка
        - | Проверяет, содержит ли событие не более одного определения события.
          | Пример **неправильного** использования правила:

               .. image:: _static/errors/Linter_err_23.png
                :width: 50
                :align: center

          | Пример **правильного** использования правила:

               .. image:: _static/errors/Linter_err_24.png
                :width: 50
                :align: center
      * - **Отсутствует элемент bpmndi**
        - Ошибка
        - | Проверяется отсутствие информации BPMNDI для элементов BPMN, которые должны иметь визуальное представление.
          | На каждый элемент BPMN (который требует визуального представления) ссылается элемент BPMNDI, который определяет, как визуально отображать соответствующий элемент. 
          | Может случиться так, что пользователь случайно удалит такой элемент BPMNDI (например, непосредственно работая с XML). Это может привести к ошибкам, так как элемент BPMN по-прежнему интерпретировался бы при выполнении процесса, но больше не был бы виден в средствах графического моделирования. 








