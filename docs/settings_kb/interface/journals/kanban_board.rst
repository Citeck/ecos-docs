Канбан-доска
============

.. _kanban_board:

.. contents::
    :depth: 3

**Канбан-доска** - представление данных системы выбранного типа данных, является дополнительным представлением журнала.

В колонках доски отображаются статусы выбранного типа, а на самой доске - созданные экземпляры этого типа на основе примененного фильтра.

.. image:: _static/kanban/KB1.png
       :width: 700
       :align: center

У журнала может быть несколько сконфигурированных канбан-досок – для их просмотра необходимо нажать **Список досок**.

Фильтры, примененные в журнале, применяются и на канбан-доске, и наоборот. По нажатию на **Шаблоны настроек** открываются сохраненные шаблоны настроек, доступные для данного журнала. 

При открытии доски по умолчанию отображается тот шаблон, который выбран для журнала по умолчанию.

.. image:: _static/kanban/KB16.png
       :width: 600
       :align: center

Карточки можно переносить из одной колонки в другую. 

.. image:: _static/kanban/KB_dnd.png
       :width: 700
       :align: center

Если перенос в соответствии с бизнес-процессом не возможен, указывается ошибка. Например:

.. image:: _static/kanban/KB11.png
       :width: 300
       :align: center


Настройка колонок канбан доски
------------------------------

Настроить фильтрацию элементов, порядок и отображение колонок можно, нажав:

.. image:: _static/kanban/KB13.png
       :width: 500
       :align: center

Предоставлен весь список статусов типа данных, к которому относится текущий журнал. Чекбоксами можно отметить те статусы, которые необходимо отражать на канбан-доске.

.. image:: _static/kanban/KB14.png
       :width: 500
       :align: center

Нажмите **Применить**, на канбан-доске будут показаны выбранные в настройках статусы и элементы в этих статусах:

По нажатию на:

.. image:: _static/kanban/KB18.png
       :width: 700
       :align: center

примененный фильтр сбрасывается.

Выбранные настройки можно сохранить в шаблон, нажав **Создать шаблон**:

.. image:: _static/kanban/KB15.png
       :width: 400
       :align: center

укажите название, для кого он доступен (пользователи, группы), сохраните.

Применение шаблона
--------------------

Сохраненные шаблоны доступны по нажатию на **Шаблоны настроек** :

.. image:: _static/kanban/KB17.png
       :width: 700
       :align: center

Шаблон можно отредактировать или удалить

Конфигурация канбан-доски
--------------------------

Журнал с конфигурациями **"Канбан доски" (Рабочее пространство "Раздел администратора" - Конфигурация UI)**:

.. image:: _static/kanban/KB2.png
       :width: 700
       :align: center

Действия
~~~~~~~~~
Возможные действия с доской:

.. image:: _static/kanban/KB9.png
       :width: 700
       :align: center
       :alt: Доска действия

- Просмотреть свойства
- Скачать
- Удалить
- Редактировать свойства
- Редактор json
- Копировать

Форма создания
~~~~~~~~~~~~~~

**+ → Создать конфигурацию канбан-доски**

 .. image:: _static/kanban/KB4.png
       :width: 600
       :align: center

.. list-table:: 
      :widths: 5 40 5
      :header-rows: 1
      :class: tight-table  

      * - Поле
        - Описание
        - Номер 
      * - **Идентификатор доски**
        - | Уникальный идентификатор доски. Например, test_board (snake case)
          | Если идентификатор не заполнять, то он будет сгенерирован автоматически. Например, c8393bfa-5291-464d-88b7-7ae822516e02
        - 
      * - **Имя канбан-доски**
        - | Отображаемое имя доски. Отображается в списке канбан-досок, и как title страницы. Укажите вручную. 
          | Может быть пустым.
        - 
      * - **Возможно ли перемещать сущности между статусами**
        - | Использование drag’n’drop при перемещении между статусами. 
          | **Внимание!** Перемещение не означает изменение бизнес-процесса.
        - 7
      * - **Скрыть заголовок**
        - | Возможность убирать заголовок канбан карточки
        - 5
      * - **Шаблон заголовка карточки**
        - | Настройка вида ``№ ${numberAtt} - ${?disp}``, которая по шаблону меняет заголовок карточки в канбане.
        - 5
      * - **Положение названия полей карточки**
        - | Возможность выбрать расположение названий полей карточки: слева или сверху.
        - 2
      * - **Тип данных**
        - | Тип сущности, который необходимо отражать на доске. Выбор осуществляется из списка всех уже созданных типов. 
          | Может быть выбрано только 1 значение. 
          | В соответствии с типом в колонках можно выбирать связанные с ним статусы.
        - 
      * - **Журнал**
        - | Журнал для типа данных. 
          | Для какого журнала создается представление канбан-доска. 
          | Выбор осуществляется из списка всех уже созданных журналов. Может быть выбрано только 1 значение.
        - 1
      * - **Форма**
        - | Форма карточки для отображения сущности. 
          | Выбор осуществляется из списка всех уже созданных типов. Может быть выбрано только 1 значение. 
          | Если форму не выбирать, то на канбан-доске будет отображение сущности по умолчанию со следующими данными: 
          | Автор; Дата создания.
        - 4
      * - **Действия**
        - | Действия над сущностью на доске. Выбор осуществляется из списка всех уже созданных действий. 
          | Может быть выбрано несколько значений.
        - 
      * - **Колонки**
        - Конфигурация колонок
        - 3

Соответствие полей конфигурации и интерфейса:

 .. image:: _static/kanban/KB5.png
       :width: 700
       :align: center

Возможное положение названия полей карточки:

.. list-table::
      :widths: 20 20
      :align: center

      * - **Сверху**
        - **Слева**
      * - |

            .. image:: _static/kanban/card_up.png
                  :width: 200
                  :align: center

        - |

            .. image:: _static/kanban/card_left.png
                  :width: 200
                  :align: center

Настройка колонок
~~~~~~~~~~~~~~~~~~~~~~~~~

В колонке **«Статус»** выберите статус из выпадающего списка. Статусы в выпадающем списке указаны в соответствии с выбранным **типом данных**.

 .. image:: _static/kanban/KB6.png
       :width: 600
       :align: center

В колонке **«Имя** укажите название, которое будет отображаться на канбан-доске. По умолчанию выбранный статус автоматически указывается и в колонке **«Имя»**, можно изменить на необходимое.

 .. image:: _static/kanban/KB7.png
       :width: 600
       :align: center

Для каждой колонки можно скрыть элементы старше, чем указанная продолжительность:

 .. image:: _static/kanban/KB20.png
       :width: 600
       :align: center

Продолжительность указывается в днях:

 .. image:: _static/kanban/KB21.png
       :width: 600
       :align: center

На доске для колонок с включенной настройкой будут скрываться элементы с датой перехода в статус больше, чем указанная продолжительность.


Общая сумма по каждой колонке
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. _kanban_column_sum:

На канбан-доске можно отображать общую сумму по каждой колонке, что актуально для договоров, сделок и в других случаях, связанных с использованием денежных сумм.

 .. image:: _static/kanban/summ_01.png
       :width: 700
       :align: center

В каждой колонке канбан-доски отображается общая сумма по всем карточкам в данной колонке. При перемещении карточки в другой статус общая сумма пересчитывается в обеих колонках: предыдущий статус и новый статус.

Параметр задается для каждой колонки и учитывает только числовой атрибут для суммирования.

 .. image:: _static/kanban/summ_02.png
       :width: 600
       :align: center

Для каждого рабочего пространства суммы индивидуальны, и не являются общими для всех рабочих пространств одного типа.

Если суммы в карточках внесены в разных валютах, то общая сумма содержит несколько записей с обозначением валют. Число записей при этом равно числу используемых валют в данной колонке в данном рабочем пространстве.


Заполненная конфигурация
-------------------------

 .. image:: _static/kanban/KB8.png
       :width: 600
       :align: center


Изменение полей формы карточки
--------------------------------

Кликните на форму:

 .. image:: _static/kanban/form_card_00.png
       :width: 600
       :align: center

Удалите, добавьте необходимые поля:

.. list-table::
      :widths: 20 20
      :align: center

      * - |

            .. image:: _static/kanban/form_card_01.png
                  :width: 500
                  :align: center

        - |

            .. image:: _static/kanban/form_card_02.png
                  :width: 500
                  :align: center


Связь канбан-доски и типа данных
----------------------------------

Созданная канбан доска может быть задана и в типе данных:

 .. image:: _static/kanban/KB10.png
       :width: 600
       :align: center

