
Связь формы с задачей
=====================

Завершение задачи (outcome)
---------------------------

Для кнопок, которые должны завершать задачу следует указывать свойство **Имя свойства/Property Name** по следующему формату: 

``outcome_******``

 где ``******`` - результат выполнения задачи.

 .. image:: _static/for_task/for_task_3.png
       :width: 500
       :align: center

В процессе можно добавлять **exclusive gateway** с несколькими выходами по условию нажатой кнопки.

Для проверки нажатой кнопки следует проверить переменную ``form_{{FORM_KEY}}_outcome`` или ``outcome``. Например:

.. code-block::

    form_testkey_outcome == 'Rework'

Аттрибуты задачи
------------------

Для аттрибута **"комментарий"** свойство **Имя свойства/Property Name (warning)** должно быть **comment**. 

Для миграции существующих форм, где ключ отличается, следует сделать невидимое поле с нужным ключом, которое будет копировать значение из поля **comment**.  

Для аттрибутов, которые должны загружаться из привязанного к задаче документа, следует указывать префикс **_ECM_**. 

Пример: 

.. code-block::

    _ECM_cm:title

Все аттрибуты, которые хранятся непосредственно в задаче, доступны по прямому имени без преобразований.

Связь формы с задачей
----------------------

Привязать новую форму можно следующим образом:

Flowable
~~~~~~~~~~~~

1. В поле **Form Key** пользовательской задачи необходимо устанавить произвольное значение и запомнить его.
2. Поле **Form Reference** должно быть пустым.

 .. image:: _static/for_task/for_task_1.png
       :width: 600
       :align: center

При создании формы в поле **Key** нужно указать тот же ключ:

 .. image:: _static/for_task/for_task_2.png
       :width: 600
       :align: center

Activity
~~~~~~~~~~~~

Задачи activity исторически привязаны к модели Alfresco и в **formKey** записывается тип Alfresco.

Для создания формы задачи нужно взять **formKey** из задачи (например, **ctrwf:selectSignerTask**) и дописать в начало префикс **alf_** (например **alf_ctrwf:selectSignerTask**).

Полученный ключ записываем в поле **Key** при создании или редактировании формы.


Вид формы задачи
------------------

Кнопки должны располагаться с левого края под полем комментария.

Кнопки, несущие отрицательный характер, должны быть всегда слева от кнопок, несущих положительный характер. 

Если кнопок 3, то располагать в соответствии со смыслом: от отрицательного к положительному решению.

По ширине кнопки и отступы между кнопками не должны быть слишком большими.

Примеры:

 .. image:: _static/for_task/for_task_4.png
       :width: 600
       :align: center

|

 .. image:: _static/for_task/for_task_5.png
       :width: 600
       :align: center

