Рабочие пространства в Citeck
===============================

.. _workspaces:

.. contents::
    :depth: 3

Для улучшения навигации и работы в Citeck реализовано разделение данных, пунктов меню и открытых вкладок по **рабочим пространствам (workspace)**.

**Рабочее пространство** - отдельная область в Citeck для совместной работы пользователей над определенной функциональностью. Например, пространство «Договоры» и «Доверенности», в котором пользователи, имеющие к нему доступ, работают с договорами, доверенностями и общесистемными справочниками. 
Либо пространство определённого проекта, в котором команда этого проекта работает с тикетами и запросами на изменение. При этом команда проекта работает в своем рабочем пространстве и не видит данных других проектов. 

**Пользователь:**

•	может выбирать рабочее пространство из списка тех, к которым имеет доступ:

 .. image:: _static/workspaces/01_button_select.png
       :width: 700
       :align: center 

•	видит только те пункты меню (левом и верхнем), вкладки (табы) и данные (объекты типов данных), которые относятся к выбранному рабочему пространству, например для **Service Desk**:

 .. image:: _static/workspaces/02.png
       :width: 700
       :align: center 

•	видит в рабочем пространстве объекты только тех типов данных, которые были добавлены на это рабочее пространство (а также «общие» типы данных, которые относятся к глобальному пространству)
•	видит в Библиотеке документов рабочего пространства только те файлы и папки, которые относятся к этому пространству

 .. image:: _static/workspaces/05_doclib.png
       :width: 700
       :align: center 

**Администратор:**

•	может управлять рабочими пространствами (создавать, изменять, удалять), настраивать для них пункты меню и типы данных.
•	может указывать для типов данных принадлежность к глобальному или частному рабочему пространству. Данный функционал позволяет настраивать типы данных, объекты которых будут общими для всех рабочих пространств (например, общие справочники)
•	может добавлять (и убирать) типы данных к рабочему пространству, тем самым разграничивая объекты типов данных по рабочим пространствам. Например, при добавлении типа данных «Договор» к рабочим пространствам «Договоры компании А» и «Договоры компании Б», договоры не будут пересекаться для этих рабочих пространств.

По умолчанию при развертывании системы создается Глобальное рабочее пространство, которое выбрано по умолчанию. 

Коробочные функциональные модули разбиты по рабочим пространствам для удобства навигации. 

Включение настройки
--------------------

Перейдите в журнал :ref:`«Конфигурация ECOS»<configuration_admin>`. 

Журнал доступен по адресу: ``v2/admin?journalId=ecos-configs&type=JOURNAL``

В поисковой строке введите **workspaces-enabled**, откройте настройку:

 .. image:: _static/workspaces/setting_01.png
       :width: 600
       :align: center 

выставите **«Включить»** и сохраните.

 .. image:: _static/workspaces/setting_02.png
       :width: 300
       :align: center 

Выбор рабочего пространства
-----------------------------

В левом верхнем углу доступна кнопка для выбора доступных рабочих пространств и создания нового:

 .. image:: _static/workspaces/01_button_select_00.png
       :width: 700
       :align: center 

Указаны самые релевантные **(1)**, остальные рабочие пространства, которым у вас есть доступ, и публичные, к которым можно присоединиться, доступны по нажатию на **Посмотреть больше (2)**:

      - Мои пространства

      .. image:: _static/workspaces/01_button_select_01.png
            :width: 700
            :align: center 

      - Публичные пространства

      .. image:: _static/workspaces/01_button_select_02.png
            :width: 700
            :align: center 

Для присоединения к пространству нажмите:

 .. image:: _static/workspaces/01_button_select_03.png
       :width: 500
       :align: center 

Подтвердите выбор:

 .. image:: _static/workspaces/01_button_select_04.png
       :width: 400
       :align: center 

и далее откроется страница с пространством.

Общий вид рабочего пространства:

 .. image:: _static/workspaces/wp_overview.png
       :width: 700
       :align: center 

**1** - Переход к домашней странице рабочего пространства. См. ниже о :ref:`настройке домашней страницы<workspace_settings>`. 

**2** - Разделы рабочего пространства

Доступные действия с рабочими пространствами
-----------------------------------------------

.. list-table::
      :widths: 20 20
      :align: center

      * - |

            .. image:: _static/workspaces/actions.png
                  :width: 600
                  :align: center

        - |

            .. image:: _static/workspaces/actions_1.png
                  :width: 600
                  :align: center


1. Пользователь не является участником публичного пространства - **Присоединиться**.
2. Пользователь является участником публичного пространства, приватного пространства  -  **Перейти в пространство**, **Выйти из пространства**.
3. Если текущий пользователь является единственным менеджером публичного или приватного пространств, то при попытке выйти из пространства отображается сообщение: **"Вы не можете покинуть пространство, так как являетесь единственным менеджером"**:

 .. image:: _static/workspaces/actions_2.png
       :width: 700
       :align: center 

4. Для пользователей с ролью **менеджер** доступна возможность **удалить** публичное или приватное пространства:

 .. image:: _static/workspaces/actions_3.png
       :width: 700
       :align: center 

Если пользователь переходит в пространство по прямой ссылке, и он не является участником данного пространства, то отображается сообщение с выбором: присоединиться к рабочему пространству или перейти в личное пространство.

 .. image:: _static/workspaces/actions_4.png
       :width: 700
       :align: center 

Доступные рабочие пространства
-------------------------------

Персональное рабочее пространство
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Индивидуальное пространство на платформе предназначено для организации работы пользователя, управления задачами и документами, а также участия в бизнес-процессах. 

В пространстве можно настроить в :ref:`домашнюю страницу и меню<workspace_settings>`.

Задачи
"""""""

 .. image:: _static/workspaces/02_personal_workspace.png
       :width: 700
       :align: center 

Раздел **«Задачи»** содержит 

    -	**Текущие задачи** - все задачи, которые могут быть выполнены пользователем, как единственным исполнителем, так и в составе групп.
    -	**Завершенные задачи** - выполненные пользователем задачи
    -	**Задачи подчиненных** - задачи пользователей, у которых текущий пользователь указан в их профилях как Линейный руководитель.

Библиотека документов
"""""""""""""""""""""

Представляет собой иерархический интерфейс для работы с папками и документами.

 .. image:: _static/workspaces/05_doclib.png
       :width: 700
       :align: center 

В библиотеке загрузка файлов и папок доступна как по кнопке, так и перетаскиванием.

 .. image:: _static/workspaces/05_doclib_01.png
       :width: 700
       :align: center 

.. _kanban_new_doc:

По кнопке **+** доступно как добавление файлов и папок, так и создание документов:

 .. image:: _static/workspaces/doc_01.png
       :width: 600
       :align: center 

Выберите тип документа, укажите название:

 .. image:: _static/workspaces/doc_02.png
       :width: 500
       :align: center 

В OpenOffice создается новый файл, в котором можно вести совместную работу:

 .. image:: _static/workspaces/doc_04.png
       :width: 700
       :align: center 

Над документом могут работать несколько пользователей одновременно.

Подробно о функционале см. :ref:`Библиотека документов<document_library>`

Канбан задачи
""""""""""""""

**Канбан** – наглядное представление персональных задач в виде виртуальной доски. 

 .. image:: _static/workspaces/06_kanban.png
       :width: 700
       :align: center 

В колонках доски отображаются статусы задач, на самой доске - задачи распределены по статусам. По клику на наименование задачи можно перейти в карточку задачи.

Переход между статусами может осуществляться через канбан доску перемещением карточки по столбцам.

 .. image:: _static/workspaces/06_kanban_01.png
       :width: 700
       :align: center 

Для создания задачи нажмите **+**. Форма создания задачи аналогична форме создания поручения, но в ней отсутствуют поля  **Исполнитель** и **Проверяющий**. 

 .. image:: _static/workspaces/06_kanban_02.png
       :width: 600
       :align: center 
 
См. подробно о :ref:`Поручениях<ecos-assignments>`.


Совместное рабочее пространство
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 .. image:: _static/workspaces/joint_ws_01.png
       :width: 700
       :align: center 

Совместное рабочее пространство предназначено для коллективной работы команд, отделов или проектных групп. Оно объединяет участников, документы, задачи и бизнес-процессы в едином интерфейсе.

Пользователь с ролью **менеджер** может настроить в :ref:`домашнюю страницу и меню<workspace_settings>`.

В **библиотеке документов** загруженные файлы и созданные документы доступны всем участникам пространства: 

 .. image:: _static/workspaces/joint_ws_02.png
       :width: 700
       :align: center 
 
На доске поручений можно создавать поручения на участников пространства:

 .. image:: _static/workspaces/joint_ws_03.png
       :width: 700
       :align: center 

Функционал :ref:`поручений<ecos-assignments>` доступен в полном объеме.

Cм. ниже о :ref:`создании рабочего пространства<new_workspace>`

По умолчанию
~~~~~~~~~~~~~~

 .. image:: _static/workspaces/03_by_default_workspace.png
       :width: 700
       :align: center 

Пространство, в котором представлены функциональные модули системы, доступные пользователю.

Пример рабочего пространства, к которому у пользователя есть доступ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 .. image:: _static/workspaces/04_sd_workspace.png
       :width: 700
       :align: center 

Работа с объектами такого рабочего пространства аналогична работе в функциональном модуле.

Настройки рабочего пространства
---------------------------------

.. _workspace_settings:

Настройка домашней страницы
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

При открытии рабочего пространства в зависимости от его типа открывается дашборд:

    -	рабочее пространство по умолчанию- **user-dashboard**;
    -	персональное рабочее пространство - **personal-ws-dashboard-default**;
    -	неперсональное рабочее пространство - **ws-dashboard-default**

Для настройки дашборда рабочего пространства выберите рабочее пространство: персональное или пространство, в котором вы **менеджер**. Перейдите в **настройки** и выберите **«Настроить страницу»**:

 .. image:: _static/workspaces/09_edit_dashboard.png
       :width: 700
       :align: center 

Откроется страница настроек домашней страницы, где можно изменить схему расположения и набор отображаемых виджетов.

В блоке **«Колонки»** можно выбрать количество и расположение колонок на домашней странице. Для выбора необходимо кликнуть по понравившейся схеме.

В блоке **«Виджеты»** можно перетащить необходимые виджеты в колонки домашней страницы.

Для сохранения изменений нажмите **«Применить»** внизу страницы.

 .. image:: _static/workspaces/10_user-dashboard.png
       :width: 600
       :align: center 

Настройка меню
~~~~~~~~~~~~~~~

Выберите рабочее пространство: персональное или пространство, в котором вы **менеджер**, перейдите в **настройки** и выберите **«Настроить меню»**:

 .. image:: _static/workspaces/09_edit_menu.png
       :width: 700
       :align: center 

Доступно как добавление раздела **(1)**, так и элементов в раздел **(2)**:

 .. image:: _static/workspaces/11_ws-menu.png
       :width: 500
       :align: center 

См. подробно о каждом :ref:`добавляемом элементе<menu_element_types>` 

Например, добавим в меню журнал «Договоры»:

 .. image:: _static/workspaces/11_ws-menu_01.png
       :width: 500
       :align: center 

Обновленное меню станет доступно для всех пользователей рабочего пространства.

 .. image:: _static/workspaces/11_ws-menu_02.png
       :width: 700
       :align: center 

Создание и редактирование рабочего пространства
-------------------------------------------------

.. _new_workspace:

Создание рабочего пространства
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Нажмите **«Создать пространство»**:

 .. image:: _static/workspaces/07_new_workspace.png
       :width: 700
       :align: center 

Вкладка **«Основное»**:

 .. image:: _static/workspaces/07_new_workspace_01.png
       :width: 600
       :align: center 

.. list-table:: 
      :widths: 5 10 30 30
      :header-rows: 1
      :align: center
      :class: tight-table 

      * - п/п
        - Наименование
        - Описание
        - Пример заполнения
      * - 1
        - **Id**
        - уникальный идентификатор рабочего пространства
        - doc_prep
      * - 2
        - **Имя**
        - локализованное название рабочего пространства
        - Подготовка документов
      * - 3
        - **Видимость**
        - | Публичное - любые пользователи смогут присоединиться к пространству
          | Приватное - пространство доступно только выбранным пользователям
        - Приватное
      * - 4
        - **Описание**
        - локализованное описание рабочего пространства
        - Подготовка документов для проектов
      * - 5
        - **Участники рабочего пространства**
        - | выбор из оргструктуры участников и предоставление им прав: пользователя или менеджера (с возможностью управления рабочим пространством). 
          | Пользователь, создающий пространство, получает роль **«Менеджер»** и будет указан как создатель.
        - 

            .. image:: _static/workspaces/07_new_workspace_02.png
                  :width: 600
                  :align: center 

      * - 6
        - **Шаблон**
        - выбор :ref:`шаблона<template_workspace>` на основании которого, будет создано рабочее пространство
        - 

Вкладка **«Дополнительно»**:

 .. image:: _static/workspaces/07_new_workspace_05.png
       :width: 600
       :align: center 

.. list-table:: 
      :widths: 5 10 30 30
      :header-rows: 1
      :align: center
      :class: tight-table 

      * - п/п
        - Наименование
        - Описание
        - Пример заполнения
      * - 1
        - **Адрес домашней страниц**
        - | адрес, который будет открываться при переходе в рабочее пространство и при нажатии на логотип в меню.
          | Если для рабочего пространства домашняя страница не задана, то по умолчанию открывается **/v2/dashboard**.
        - 
      * - 2
        - **Иконка**
        - выбор иконки рабочего пространства
        - 

Созданное пространство выглядит аналогично персональному пространству и доступно для пользователей, которые были выбраны как участники рабочего пространства.

 .. image:: _static/workspaces/07_new_workspace_03.png
       :width: 700
       :align: center 

Пользователи могут добавлять и редактировать файлы, ставить поручения.

Редактирование рабочего пространства
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Редактирование рабочего пространства доступно пользователю с правами **«Менеджер»**:

 .. image:: _static/workspaces/07_new_workspace_04_edit.png
       :width: 700
       :align: center 

Участникам рабочего пространства можно изменить роль, добавить участников в пространство, изменить описание и видимость.

Уведомления
-------------

Пользователи получают уведомления на электронную почту, если были добавлены или удалены из рабочего пространства.

Рабочее пространство администратора
-------------------------------------

 .. image:: _static/workspaces/08_admin_workspace.png
       :width: 700
       :align: center 

Пространство содержит пункты для конфигурации и настройки системы.

 .. image:: _static/workspaces/08_admin_workspace_01.png
       :width: 700
       :align: center 


Администрирование рабочих пространств
---------------------------------------

Тип данных
~~~~~~~~~~

 .. image:: _static/workspaces/data_type_02.png
       :width: 600
       :align: center 

**Видимость** в рабочих пространствах:

    -	**По умолчанию** – назначается типу данных по умолчанию. 
    -	**Приватная** – экземпляры типа данных доступны в рамках рабочего пространства, в котором созданы. 
    -	**Публичная** –  экземпляры типа данных доступны пользователям в соответствии с правами, не зависимо от рабочего пространства, в котором созданы. 

Рабочее пространство по умолчанию – в каком рабочем пространстве будет отображаться по умолчанию.

Рабочие пространства
~~~~~~~~~~~~~~~~~~~~

В разделе администратора в подразделе **«Модель»** добавлен журнал **«Рабочие пространства»**:

 .. image:: _static/workspaces/journal.png
       :width: 700
       :align: center 

В журнале можно создать, отредактировать, удалить пространство.

Шаблоны рабочих пространств
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. _template_workspace:

Шаблон содержит уже настроенные пункты меню, дашборды разделов и домашней страницы.

В разделе администратора в подразделе **«Модель»** добавлен журнал **«Шаблоны рабочих пространств»**:

 .. image:: _static/workspaces/template_1.png
       :width: 700
       :align: center 

Создание шаблона
""""""""""""""""""
1.	Создайте новое **рабочее пространство**. Настройте в этом рабочем пространстве **меню** и **дашборд(ы)**.
2.	Перейдите в журнал **«Шаблоны рабочих пространств»**, нажмите **+ - Создать**.
3.	Выберите созданное в п.1 **рабочее пространство**, укажите **id** и **Имя**, сохраните. 

 .. image:: _static/workspaces/template_2.png
       :width: 600
       :align: center 

4.	Опционально скачайте новый шаблон и загрузите его в ecos-app или в микросервис по пути **artifacts/model/workspace-template**
5.	Опционально загрузите шаблон на стенд (если необходимо его использовать не на том стенде, где он был создан) вручную или через деплой ecos-app/микросервиса.
6.	Перейдите в журнал **«Рабочие пространства»**, нажмите **+ - Создать**.

 .. image:: _static/workspaces/template_4.png
       :width: 700
       :align: center 

7.	В поле **«Шаблон»** выберите шаблон, который создали в п.3. Заполните остальные обязательные поля и нажмите **«Создать»**.

 .. image:: _static/workspaces/template_5.png
       :width: 600
       :align: center 

8.	Откройте созданное в п.7 рабочее пространство - в нем меню и дашборд совпадают с теми, что были настроены в п.1

 .. image:: _static/workspaces/template_6.png
       :width: 700
       :align: center 

При создании шаблона конфигурации меню и дашбордов копируются внутрь шаблона (т.е. последующие изменения меню/дашбордов шаблон автоматически не обновит). 

Чтобы обновить артефакты в шаблоне предусмотрено действие **«Обновить шаблон»** в журнале **«Шаблоны рабочих пространств»**.

 .. image:: _static/workspaces/template_7.png
       :width: 700
       :align: center 

При создании рабочего пространства на основе шаблона создаются новые конфигурации меню и дашбордов с автоматически сгенерированным id и явно указанным полем workspace.
