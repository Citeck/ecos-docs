Модуль CRM
===========

.. _ecos-crm:

Модуль поддерживает процессы маркетинга, продаж и обслуживания клиентов компании, а именно помогает:

	-	упорядочить и сохранить данные клиентов;
	-	обеспечить их практическое применение;
	-	помогает отслеживать клиентов на каждом этапе продаж. 

.. contents::
		:depth: 2

Роли
----

.. list-table::
      :widths: 10 40
      :class: tight-table 
      
      * - **Менеджер по продажам**
        - Пользователь Системы (сотрудник Компании), запустивший сделку в работу
      * - **Коммерческий директор**
        - Пользователь Системы (сотрудник Компании), принимающий решение по сделкам.

Статусы
--------

.. list-table::
      :widths: 20 60
      :class: tight-table 
      
      * - **Не обработана**
        - Новая сделка.
      * - **Первичный контакт**
        - Общение с потенциальным заказчиком
      * - **Сбор потребностей**
        - Уточнение и формирование требований заказчика
      * - **Презентация**
        - Подготовка презентации компании, продукта
      * - **Подготовка КП**
        - Подготовка коммерческого проекта
      * - **Прототип**
        - Подготовка прототипа продукта
      * - **Принятие решения**
        - Принятие решения по сделке
      * - **Завершена**
        - Успешное завершение сделки
      * - **Пауза**
        - Пауза по сделке
      * - **Отказ**
        - Отказ по сделке
      * - **Исторические заявки**
        - Неактуальные заявки

Журнал
------

 .. image:: _static/crm/CRM_1.png
       :width: 600
       :align: center

Журнал содержит поля:

	-	Имя;
	-	Компания;
	-	Контрагент;
	-	Бюджет;
	-	Описание;
	-	ФИО;
	-	E-mail;
	-	Телефон;
	-	Ответственный;
	-	Дата создания;
	-	Источник обращения;
	-	Письмо
	-	Статус.

Для журнала доступно представление :ref:`канбан<kanban_board>`. Столбцы соответствуют статусам сделки.

 .. image:: _static/crm/CRM_12.png
       :width: 600
       :align: center

Например, https://host/v2/journals?journalId=deals-journal&viewMode=kanban 

Создание сделки
------------------

Создание сделки возможно как с помощью кнопки быстрого создания: 

 .. image:: _static/crm/CRM_2.png
       :width: 300
       :align: center


так и из журнала **«Сделки»**:

 .. image:: _static/crm/CRM_3.png
       :width: 600
       :align: center

На экране открывается форма создания Сделки:

 .. image:: _static/crm/CRM_4.png
       :width: 600
       :align: center

.. list-table::
      :widths: 20 60
      :class: tight-table 
      
      * - **Раздел Основное**
        - 
      * - **Номер**
        - Номер сделки. Заполняется автоматически после сохранения. 
      * - **Компания**
        - Наименование компании
      * - **Контрагент**
        - Выбрать контрагента из справочника, если уже является клиентом
      * - **Бюджет**
        - Бюджет сделки
      * - **Ответственный**
        - Выбрать менеджера, ответственного за сделку
      * - **Дата создания**
        - Заполняется автоматически, может быть изменена
      * - **Описание**
        - Описание запроса потенциального клиента
      * - **Раздел Контакт**
        - 
      * - **ФИО**
        - ФИО обратившегося представителя компании. 
      * - **Телефон**
        - Номер телефона представителя 
      * - **E-mail отправителя**
        - Электронный адрес представителя
      * - **Источник обращения**
        - Источник обращения из списка
      * - **Раздел Заявка с сайта**
        - 
      * - **E-mail**
        - Электронный адрес представителя
      * - **Откуда пришел на сайт**
        - Информация из заявки, которую заполняет представитель
      * - **Идентификатор GA**
        - Идентификатор тега Google Analytics
      * - **Идентификатор YM**
        - Идентификатор тега Яндекс. Метрики
      * - **Почтовое сообщение**
        - Содержит информацию из письма, направленного на email. См. Настройки для парсинга писем

Заполненная карточка 
---------------------

 .. image:: _static/crm/CRM_5.png
       :width: 600
       :align: center

Виджет «Стадии»
~~~~~~~~~~~~~~~~~~

.. note::

	Виджет доступен только в **enterprise** версии.

Карточка сделки содержит виджет :ref:`«Стадии»<widget_stages>`.

 .. image:: _static/crm/CRM_6.png
       :width: 500
       :align: center

Виджет визуализирует прохождение статусов сделки:

.. list-table::
      :widths: 20 50
      :header-rows: 1
      :class: tight-table 
            
      * - Стадия
        - Соответствующие статусы
      * - **0% - Обработка**
        - Не обработана
      * - **20% - Квалификация**
        - Первичный контакт, Сбор потребностей
      * - **40% - Развитие**
        - Презентация, Подготовка КП, Прототип
      * - **60% - Подтверждение**
        - Принятие решения
      * - **100% - Победа**
        - Завершена
      * - **Отказ/Пауза**
        - Отказ, Пауза

Смена статуса
-------------

Переход между статусами осуществляется через канбан доску перемещением карточки по столбцам. Столбцы соответствуют статусам сделки.

 .. image:: _static/crm/CRM_7.png
       :width: 700
       :align: center

Или **«Ответственному»** через действие **«Изменить статус»**:

 .. image:: _static/crm/CRM_10.png
       :width: 250
       :align: center

выберите необходимый статус и нажмите **«Отправить»**:

 .. image:: _static/crm/CRM_11.png
       :width: 500
       :align: center

Создание поручения по сделке
---------------------------------------

Cоздать поручение можно из карточки сделки, выбрав действие **«Создать поручение»**. См. подробно :ref:`Создание поручения из карточки<ecos-assignments-action>`

Настройки для парсинга писем
-----------------------------

Автоматически из полученного письма заполняются следующие поля заявки:

	* Содержание обращения
	* Автор
	* Электронный адрес

Настройка **mail-inbox-crm (Конфигурация почтового ящика IMAP для чтения писем в CRM Camel route)**:

 .. image:: _static/crm/CRM_8.png
       :width: 600
       :align: center

Например:

 .. image:: _static/crm/CRM_9.png
       :width: 400
       :align: center

.. code-block::

  imaps://imap.mail.ru?username=testuser1@mail.ru&password=somePassword&delete=false&unseen=true&delay=30 

Где:

.. list-table::
      :widths: 5 10
      :align: center
      :class: tight-table 
      
      * - **username**
        - Имя пользователя для входа.
      * - **password**
        - Пароль для входа.
      * - **delete**
        - Удаляет сообщения после их обработки. Это делается путем установки флага DELETED в почтовом сообщении. Если false, вместо этого устанавливается флаг SEEN.
      * - **unseen**
        - Ограничивать ли только непрочтенными письмами.
      * - **delay**
        - Миллисекунды до следующего опроса.