Учет времени
=============

.. _ecos-worklog:

В системе разработан функционал, позволяющий вести учет времени, затраченного сотрудником на работу по конкретной задаче, документу непосредственно из карточки задачи, документа.

Вся введенная информация о введенном затраченном времени доступна в журнале **Учет времени**.

.. contents::
		:depth: 2

Ввод времени
--------------

Пользователь может вести журнал работ по своим задачам (где он единственный исполнитель или взятые на себя) для любого типа данных, где такое действие настроено.

И, соответственно, если пользователь не является участником процесса, то он не может ввести затраченное время.

Пользователь может указать время работы непосредственно в самой задаче или через журнал активных, выполненных или всех своих задач.

Форма ввода затраченного времени доступна через действие **«Записать работу»** карточке задачи, документа  в виджете действий.

Рассмотрим функционал на примере заявки SD:


 .. image:: _static/worklog/worklog_1.png
       :width: 200
       :align: center

При выборе действия открывается форма учета времени:

 .. image:: _static/worklog/worklog_2.png
       :width: 500
       :align: center

В форму обязательно введите **Затраченное время** в формате **2w 4d 6h 45m**, выберите **Линию ТП**, нажмите **Сохранить**, далее заполните **Дату начала** и **Описание работы**, если необходимо:

 .. image:: _static/worklog/worklog_3.png
       :width: 500
       :align: center

- **Оставшееся время** - разница между Сроком выполнения и суммой затраченного времени по текущей задаче. 

- **Срок выполнения** - заполняется автоматически. 

При списании автоматически вычитается время из оставшегося для данной линии и обновляется виджет :ref:`Оставшееся время<SLA_remaining_time>`

Журнал «Учет времени»
---------------------

Вся введенная информация доступна в журнале **Учет времени SD** (журнал включает и активные и завершенные задачи пользователя):

 .. image:: _static/worklog/worklog_4.png
       :width: 700
       :align: center

Поля журнала:

.. list-table::
      :widths: 10 20
      :align: center
      :class: tight-table 
      
      * - **Пользователь**
        - Пользователь, который внес данные о затраченном времени
      * - **Документ**
        - Документ, при работе над которым пользователь ввел затраченное время
      * - **Затраченное время, мин**
        - Затраченное время в минутах
      * - **Описание работы**
        - Описание выполненной работы
      * - **Дата начала**
        - Дата, когда была внесена первая запись затраченного времени
      * - **Статус документа**
        - Статус в карточке задачи, документа

В журнале можно просмотреть информацию о введенном затраченном по задаче времени:

 .. image:: _static/worklog/worklog_5.png
       :width: 600
       :align: center

Настройка типа данных
-----------------------

Для того, что бы по задачам, документам можно было списывать время, необходимо добавить в тип данных действие **Записать работу**: 

 .. image:: _static/worklog/worklog_6.png
       :width: 600
       :align: center

Как реализовано
----------------

Запись времени реализована через использование аспекта **time-trackable**:

 .. image:: _static/worklog/worklog_7.png
       :width: 500
       :align: center

В аспекте атрибут **timeTracking** представлен как дочерняя ассоциация:

 .. image:: _static/worklog/worklog_8.png
       :width: 500
       :align: center

|

 .. image:: _static/worklog/worklog_9.png
       :width: 500
       :align: center

У заявки SD через родительскую ассоциацию добавлен аспект **time-trackable**. 

У заявки по этой ассоциации добавится новая запись **timeTracking**, и далее происходит добавление аспекта.