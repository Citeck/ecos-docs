Штрих-код
==========

.. note::

    Доступно только в Enterprise версии.

Функционал штрих-кода в ECOS позволяет на основе какого-либо атрибута документа сгенерировать изображение штрих-кода, которое можно:

    1. Отобразить в карточке;

    2. Открыть для печати;

    3. Наложить на PDF документ;

Настройка штрих-кода
---------------------

Настройка осуществляется через :ref:`аспект<aspects>`, который добавляется к требуемому типу:

Аспект: **Имеет штрих-код (barcode)**

В настройках аспекта для типа есть 2 поля:

    1. Формат штрих-кода (format)

    2. Атрибут с содержимым для штрих-кода (attribute)

Наложение штрих-кода на PDF
----------------------------

Для наложения штрих-кода на PDF можно воспользоваться возможностями :ref:`трансформации содержимого<content_transformation>`

Конфигурация действия:

.. code-block::

    ---
    id: download-with-barcode
    name: Скачать с штрих-кодом
    type: transform
    config:
    trasnformations:
        - type: barcode

Если нужно перед наложением штрихкода преобразовать содержимое документа в pdf, то следует воспользоваться трансформером с типом ``“content”``. Подробнее в :ref:`трансформации содержимого<content_transformation>`

Rest API
----------

Для загрузки штрих-кода в виде изображения можно воспользоваться следующим API:

``GET /gateway/transformations/api/barcode/image?content=123``

Параметры:

.. code-block::

    barcodeFormat: String? // формат штрих-кода. По умолчанию CODE_128;
    imageFormat: String? // формат изображения. По умолчанию PNG;
    width: Int? // ширина изображения;
    height: Int? // высота изображения;
    margin: Int? // отступ от краев;
    altText: Boolean? // рендерить или нет текстовое содержимое штрих-кода. По умолчанию - Да;
    content: String? // содержимое штрих-кода. Здесь можно указать конкретную строку, которую нужно представить в виде штрих-кода. Если задано, то entityRef и attribute игнорируются;
    entityRef: String? // сущность, из которой нужно загрузить содержимое для штрих-кода;
    attribute: String? // атрибут сущности, из которого нужно загрузить содержимое для штрих-кода;
    download: Boolean? // скачать содержимое или нет. Если да, то при переходе по ссылке изображение скачивается. Если нет, то изображение открывается в браузере; 
    print: Boolean? // печатать содержимое или нет. Если да, то пользователю отправляется PDF с сгенерированным штрих-кодом и его можно распечатать;
    outputType: String? // формат результата генерации. По умолчанию мы отдаем PDF если print=true и изображение в ином случае.
                        // Этот параметр можно выставить в "json" и содержимое будет приходить в виде json'а с одним полем data, которое содержит содержимое изображения в base64 формате. 


Поддерживаемые форматы штрих-кода:

.. code-block::

AZTEC
CODABAR
CODE_39
CODE_93
CODE_128
DATA_MATRIX
EAN_8
EAN_13
ITF
PDF_417
QR_CODE
UPC_A
UPC_E