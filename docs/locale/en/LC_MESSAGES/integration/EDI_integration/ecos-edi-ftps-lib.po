# SOME DESCRIPTIVE TITLE.
# Copyright (C) 2025, Citeck
# This file is distributed under the same license as the Citeck package.
# FIRST AUTHOR <EMAIL@ADDRESS>, 2025.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: Citeck \n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2025-08-28 23:55+0300\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language: en\n"
"Language-Team: en <LL@li.org>\n"
"Plural-Forms: nplurals=2; plural=(n != 1);\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=utf-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Generated-By: Babel 2.17.0\n"

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:2
msgid "Описание ecos-edi-ftps-lib"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:5
msgid "Содержание"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:8
msgid "1. Цель либы"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:9
msgid ""
"Либа создана для обмена EDI-сообщениями с контрагентами через какой-то "
"FTP-сервер."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:11
msgid "Общий принцип работы:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:13
msgid ""
"Контрагент кладет в определенную папку сообщение, либа при активированной"
" синхронизации раз в какое-то время производит рекурсивный обход по "
"папкам на сервере и находит новые документы (подробнее в п.4)."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:15
msgid ""
"Отправка сообщений контрагенту происходит наоборот: В специальную папку "
"либа кладет EDI-сообщение и когда то в будущем контрагент его заберет "
"(подробнее в п.3)."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:18
msgid "2. Настройка интеграции"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:20
msgid ""
"Для настройки, как и для любой интеграции ЭДО - необходимо создать "
"**ecos-credentials**, **ecos-data-sources**, **edi-box** и **ecos-sync** "
"сущности."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:23
msgid "2.1. Создание ecos-credentials сущности"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:25
msgid ""
"Тут все стандартно, создаем через журнал **ecos-credentials** запись, в "
"которой указываем логин и пароль для подключения к FTP-серверу."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:28
msgid "2.2. Создание ecos-data-sources сущности"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:30
msgid ""
"Создавать необходимо сущность **\"FTP Data source\"**. Поля **id** и "
"**name** не важны."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:36
msgid "Важны **host**, **port** и **protocol**, где:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:38
msgid "``host`` - путь к серверу. В моем случае - локальный хост."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:40
msgid "``port`` - порт по которому ходим к серверу. Стандарт обычно 21."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:42
msgid "``protocol`` - на данный момент поддерживается FTP или FTPS."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:45
msgid "2.3. Создание edi-box сущности"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:47
msgid "Создаем сущность **\"FTP box\"**."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:53
msgid ""
"Самая основная часть конфигурации именно тут. Тут существует 3 раздела. В"
" верхнем разделе:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:55
msgid ""
"``id`` - указываем любой (или оставляем пустым и оно само сгенерится при "
"создании)."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:57
msgid "``name`` - любое человеко-читаемое название для этого ящика."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:59
msgid "``URL``- указываем созданный в 2.2 датасорс."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:61
msgid "``Credentials`` - указываем созданные в 2.1 креды."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:63
msgid ""
"В разделе **Box configuration** - заполняем идентификатор номером GLN "
"организации, от имени которой происходит разбор EDI-сообщений."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:65
msgid "Раздел **Other**:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:67
msgid ""
"``Outbound documents folder path template`` - шаблон пути, по которому "
"будут отправляться исходящие сообщения. Подробнее в п.3."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:69
msgid ""
"``Inbound documents folder path template`` - шаблон пути, по которому "
"будут получаться входящие сообщения. Подробнее в п.4."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:71
msgid ""
"``Search documents in subdirectories`` - чекбокс с говорящим названием, "
"который означает, что мы должны искать документы не только в папке "
"полностью соответствующей конфигу выше, но и в поддиректориях."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:73
msgid ""
"``Inbound processing policy`` - выбор из вариантов обработки входящих "
"сообщений. Существует 2 варианта - ``MOVE_AFTER_PROCESSING`` и "
"``DELETE_ON_SUCCESS``. Подробнее в п.4."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:75
msgid ""
"``Inbound documents success folder path template`` - (используется только"
" при ``MOVE_AFTER_PROCESSING``) - папка куда складываются документы, "
"которые были успешно обработаны."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:77
msgid ""
"``Inbound documents error folder path template`` - (используется только "
"при ``MOVE_AFTER_PROCESSING``) - папка, куда складываются документы, в "
"результате обработки которых получили ошибку."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:80
msgid "2.4. Создание ecos-sync сущности"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:82
msgid ""
"Ничем не отличается от остальных интеграций, можно посмотреть в общей "
"статье: :ref:`Настройка получения событий с ящиком "
"Контур_Диадок<events_kontur>`"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:84
msgid "Указывать, конечно, сущность **edi-box** из п.2.3."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:87
msgid "3. Принципы работы при отправке сообщений"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:89
msgid ""
"Вся либа построена на том, что мы указываем относительные пути в "
"конфигурации. Переменные для подстановки приходят из структуры "
"**EdiXmlRequest** из либы ``ecos-edi-commons`` `Описание работы "
"интеграции :ref:`"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:91
msgid "Эта структура состоит из следующих полей:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:100
msgid "где:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:102
msgid ""
"``ourId`` маппится для подстановки в виде ``ourId.key_from_attributes`` "
"(``OurId`` состоит из **ObjectData**. Это означает, что если в "
"**ObjectData** находится 2 значения с ключами ``key1`` и ``key2``, то в "
"шаблоне можем использовать значения по следующим ключам: ``ourId.key1`` и"
" vourId.key2``)."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:104
msgid ""
"``counterpartyId`` маппится для подстановки в виде "
"``counterpartyId.key_from_attributes`` (аналогично ourId)."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:106
msgid ""
"``ediXml`` маппится всего в 2 значения: ``document.type``, где могут быть"
" значения ORDERS, ORDRSP, DESADV, RECADV, etc и в document.lowerType, где"
" могут быть значения orders, ordrsp, desadv, recadv, etc."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:108
msgid "``data`` - полностью маппится в виде addInfo.key."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:110
msgid ""
"Для заполнения ``data`` - можно на проектах расширить интерфейс "
"``FtpCustomAddInfoProvider`` и зарегистрировать его в бине "
"``FtpCustomAddInfoProviderRegistry``. Таким образом, можно на любом "
"проекте кастомную логику по определению путей сделать. Пример шаблонов:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:116
msgid ""
"Это означает, что если в структуре data содержится значение 123456 по "
"ключу ``counterparty.esk`` и ``ediXml.ediDocumentType`` содержит значение"
" ORDERS, то данное сообщение отправится в следующую папку:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:122
msgid ""
"Можно вовсе не использовать шаблоны, тогда все документы будут попадать в"
" любую папку."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:124
msgid "Например, шаблон:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:130
msgid ""
"Разработать реализацию ``FtpCustomAddInfoProvider``, которая бы "
"возвращала переменную ``path``. Например, если она будет равна "
"``some/path/type/kind/outbound``, то путь будет следующим:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:136
msgid ""
"Для шаблонизации пути используется компонент ``StringSubstitutor`` из "
"библиотеки commons-text от Apache с небольшой модернизацией."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:138
msgid "Подробнее можно ознакомиться в тестах к либе."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:140
msgid ""
"Отправить сообщение можно с помощью интерфейса **EdiService**, передав "
"ему ``EdiProviderType.FTP``. Доступные методы:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:142
msgid ""
"``generateEdiXml`` - доступен, но пока что реализованных генераторов не "
"имеет ввиду ненадобности. Можно расширять список генераторов в рамках "
"бандла ``ecos-edi-ftps-lib`` или других, если появится такая "
"необходимость."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:144
msgid ""
"``sendEdiXml`` - отправка сообщения, данные которого сериализованы в "
"``EdiXmlRequest`` на FTP-сервер."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:146
msgid "Сервис **EdiService** доступен из микросервиса **integrations-app**."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:149
msgid "4. Принципы работы при получении сообщений"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:151
msgid "Для получения сообщений мы проходим через 3 фазы:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:153
msgid "Ищем сообщения."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:155
msgid "Обрабатываем сообщения."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:157
msgid "Фиксируем, что сообщение обработано."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:160
msgid "4.1. Обход в поиске сообщений"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:162
msgid ""
"Для поиска документов - используется рекурсивный обход по папкам. "
"Алгоритм не забирает все документы разом и отправляет их на обработку, а "
"запоминает место последнего найденного документа, отправляет на обработку"
" и позже возобновляет обход с той же точки. Реализовано это в виде "
"итератора ``FtpWalkIterator``."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:164
msgid ""
"Итератору скармливаются параметры ``Inbound documents folder path "
"template`` (далее - шаблон поиска входящих) и Search documents in "
"subdirectories (флаг поиска в поддиректориях), которые описаны в п.2.3."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:166
#, python-brace-format
msgid ""
"Шаблон поиска входящих разбивается на уровни по папкам. То есть, "
"например, шаблон "
"``/${addInfo.counterparty.esk}_S4TEST/INBOUND/${document.type}`` "
"разобьется на 4 части:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:175
msgid ""
"После этого, части будут преобразованы в корректные регулярные выражения."
" То есть, эти части будут иметь теперь следующие значения:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:184
msgid ""
"Обратите внимание, замена происходит не просто на регулярки, а создаются "
"группы для того чтоб потом вынуть эти значения для создания события Event"
" (внутри на самом деле еще заменяются точки на A1B2C3 строки, но это "
"опустим, чтобы не ухудшать читаемость). Так же, обратите внимание, "
"document.type и document.lowerType преобразуются в конкретные значения "
"enum, а остальные переменные - в регулярки из букв, цифр, пустых символов"
" или символа “-”."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:186
msgid ""
"Если включен флаг поиска в поддиректориях - к последнему регулярному "
"выражению добавляется “.*“. Таким образом становится возможным поиск по "
"подпапкам."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:188
msgid ""
"Так же, есть возможность указывать не стандартную регулярку, а свою. "
"Пример -"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:194
msgid "Алгоритм обхода:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:196
msgid ""
"Итератор внутри себя содержит очередь. В эту очередь вносятся файлы или "
"папки, которые нужно будет в будущем посмотреть и проверить на предмет "
"файлов, соответствующих регуляркам."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:198
msgid ""
"Инициализируем итератор, загрузив в очередь файлы из папки “/” (из рута)."
" Этот шаг выполняется только 1 раз."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:200
msgid "Берем из очереди следующий элемент."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:202
msgid ""
"Определяем его уровень (по количеству символов “/“). Берем "
"соответствующий этому уровню regexp (или последний, если уровень больше "
"чем есть regexp'ов)."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:204
msgid "Проверяем совпадение по regexp."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:206
msgid ""
"3.1. Если совпадает - смотрим, папка это или файл. Если папка - выбираем "
"из нее список файлов и ложим в начало очереди для дальнейшего разбора, "
"переходим на пункт 1. Если файл (для файлов проверяем только на "
"соответствие последнему регулярному выражению) - отправляем его на "
"обработку."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:208
msgid "3.2. Не совпадает - выбрасываем элемент из очереди. Переходим на пункт 1."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:211
msgid "4.2. Обработка сообщения"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:212
msgid "Этот шаг состоит из 2х пунктов:"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:214
#, python-brace-format
msgid ""
"Наполнения **Event** (Что такое Event в интеграции - можно почитать тут "
":ref:`Описание работы интеграции<EDI>`. Как уже написано выше, необходимо"
" запомнить группы из regexp. Сделано это для того, чтобы передать по тем "
"же ключам значения в структуру **Event**. То есть, для шаблона поиска "
"входящих "
"``/${addInfo.counterparty.esk}_S4TEST/OUTBOUND/${document.type}`` - в "
"структуру **Event** пробросятся значения из пути сообщения на "
"FTP-сервере."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:216
msgid ""
"Дальше, созданный **Event** отправляется в **EdiStateService** "
"(:ref:`Описание работы интеграции<EDI>`) для обработки дальше системой "
"силами роутов Camel."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:219
msgid "4.3. Фиксация обработанного сообщения"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:221
msgid ""
"После успешной (или не успешной) обработки сообщения - необходимо "
"зафиксировать, что сообщение было обработано. Происходит это за счет "
"выбранной политики, переданной через конфигурацию Inbound processing "
"policy (см. п.2.3)."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:224
msgid "4.3.1. Политика MOVE_AFTER_PROCESSING"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:226
msgid ""
"В случае успеха - перемещаем файл в папку, которая указана в конфигурации"
" ``Inbound documents success folder path template`` (см. п.2.3)."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:228
msgid ""
"В случае провала - перемещаем файл в папку, которая указана в "
"конфигурации ``Inbound documents error folder path template`` (см. "
"п.2.3)."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:230
msgid ""
"Обратите внимание, оба этих параметра являются шаблонами. В шаблонах "
"можно использовать переменные, которые участвуют в шаблоне поиска "
"входящих (пример можно посмотреть на скриншоте в п.2.3)."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:233
msgid "4.3.2. Политика DELETE_ON_SUCCESS"
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:235
msgid "В случае успешно обработанного события - файл удаляется с FTP-сервера."
msgstr ""

#: ../../integration/EDI_integration/ecos-edi-ftps-lib.rst:237
msgid "В случае провала - ничего не происходит."
msgstr ""

